version: '3.9'
services:
    client:
        build: ./client
        volumes:
            - ./client/client:/code/client
        networks:
            - client
            - server
        depends_on:
            - server
    server:
        build: ./server
        volumes:
            - ./server/server:/code/server
        ports:
            - 10000-11000:10000
            - 5000-5500:5000
        deploy:
            mode: replicated
            replicas: 2
        networks:
            - server
        depends_on:
            - master

    master:
        build: ./master
        volumes:
            - ./master/:/code/master
        ports:
            - 6789:6789

networks:
    client:
        driver: bridge
    server:
        driver: bridge
